<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>3D Earth – IS‑9 & IS‑10 Tracker</title>
    <style>
        body { margin:0; overflow:hidden; background:#000; }
        #overlay {
            position:absolute; top:10px; left:10px;
            color:#fff; background:rgba(0,0,0,.6);
            font:14px/1.3 monospace; padding:8px 12px; border-radius:6px;
        }
    </style>
    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three@0.176.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.176.0/examples/jsm/"
          }
        }
    </script>
</head>
<body>

<script type="module">
    async function loadUMD(urls) {
        for (const u of urls) {
            try {
                await new Promise((ok, bad) => {
                    const s = document.createElement('script');
                    s.src = u; s.onload = ok; s.onerror = () => bad(new Error('UMD load failed '+u));
                    document.head.appendChild(s);
                });
                console.log('✅ satellite.js from', u);
                return;
            } catch (e) { console.warn(e); }
        }
        throw new Error('satellite.js failed to load');
    }

    await loadUMD([
        'https://cdnjs.cloudflare.com/ajax/libs/satellite.js/4.0.0/satellite.min.js',
        'https://unpkg.com/satellite.js@4.0.0/dist/satellite.min.js'
    ]);
    // ----------------------------------------------------
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import {
        updateSatellitePosition
    } from './js/satelliteTLELoader.js';

    const scene   = new THREE.Scene();
    const camera  = new THREE.PerspectiveCamera(50, innerWidth/innerHeight, 0.1, 1000);
    camera.position.set(0,0,3);

    const renderer = new THREE.WebGLRenderer({ antialias:true });
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // Earth
    const earthTex = await new THREE.TextureLoader().loadAsync('textures/earthmap1k.jpg');
    const earth = new THREE.Mesh(
        new THREE.SphereGeometry(1,64,64),
        new THREE.MeshBasicMaterial({ map: earthTex })
    );
    scene.add(earth);

    const targets = [26451, 26766]; // IS‑9, IS‑10

    function animate() {
        requestAnimationFrame(animate);
        updateSatellitePosition(targets, new Date(), 1);
        controls.update();
        renderer.render(scene, camera);
    }
    animate();
</script>
</body>
</html>
